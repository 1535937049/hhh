<html>
  <head>
    <script>
      function checkStatus() {
        var xhttp = new XMLHttpRequest()
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            const isLoggedIn = JSON.parse(xhttp.responseText).isLoggedIn
            if (!isLoggedIn) {
              // This is NOT a security feature!
              // It's client side so provides no security. Instead, it is a user convenience.
              window.location.replace('/admin/login.html')
            }
          }
        }
        xhttp.open("GET", "/admin-api/status", true)
        xhttp.send()
      }
    </script>
  </head>
  <body onload="checkStatus()">
    <h1>TrackCOVID: Confirmation Code Admin</h2>
    <form action="/admin-api/logout" method="get">
      <input type="submit" value="Logout">
    </form>

    <h2>Confirmation codes</h2>
    <form action="/admin-api/confirmcode/generate" method="post" target="_blank">
      <p>Click the button to generate a new confirmation code.</p>
      <p>This will open a new tab with a QR confirmation code. You can print the page and deliver it to the patient.</p>
      <input type="submit" value="New confirmation code">
    </form>

  </body>
</html>
